<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <title>ChatDim AI - Full Edition (Ï‡Ï‰ÏÎ¯Ï‚ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚)</title>
  <style>
    body {
      display: flex;
      font-family: Arial, sans-serif;
      margin: 0;
      background-color: #f5f5f5;
      height: 100vh;
      overflow: hidden;
    }

    #sidebar {
      width: 250px;
      background-color: #333;
      color: white;
      padding: 10px;
      overflow-y: auto;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }

    #sidebar h3 {
      margin-top: 0;
      margin-bottom: 10px;
      user-select: none;
    }

    .chat-item {
      cursor: pointer;
      padding: 8px;
      background-color: #444;
      margin-bottom: 5px;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      user-select: none;
      transition: background-color 0.2s;
    }

    .chat-item:hover {
      background-color: #555;
    }

    .chat-item.selected {
      background-color: #0088ff;
    }

    .chat-item span.name {
      flex-grow: 1;
      padding-right: 10px;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .chat-actions button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      font-size: 14px;
      margin-left: 5px;
      user-select: none;
      padding: 2px 6px;
      border-radius: 3px;
      transition: background-color 0.2s;
    }

    .chat-actions button:hover {
      background-color: #666;
    }

    #main {
      flex-grow: 1;
      padding: 20px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    #chat {
      border: 1px solid #ccc;
      padding: 10px;
      background-color: #fff;
      flex-grow: 1;
      overflow-y: auto;
      margin-bottom: 10px;
      white-space: pre-wrap;
      line-height: 1.4em;
      border-radius: 6px;
    }

    #userInput {
      width: 80%;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    #controls {
      margin-top: 10px;
    }

    #sendBtn, #saveBtn, #speakBtn {
      padding: 10px 14px;
      margin-left: 8px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background-color: #0088ff;
      color: white;
      transition: background-color 0.2s;
      user-select: none;
    }

    #sendBtn:hover, #saveBtn:hover, #speakBtn:hover {
      background-color: #005fa3;
    }

    .message { margin: 5px 0; }
    .user { color: #005fa3; font-weight: bold; }
    .ai { color: #008000; font-weight: bold; }
  </style>
</head>
<body>

<div id="sidebar">
  <h3>ğŸ’¬ Î£Ï…Î½Î¿Î¼Î¹Î»Î¯ÎµÏ‚</h3>
  <div id="chatList"></div>
  <button id="newChatBtn" style="margin-top: auto; background:#0088ff; color:white; border:none; padding:8px; border-radius:6px; cursor:pointer;">
    â• ÎÎ­Î± Î£Ï…Î½Î¿Î¼Î¹Î»Î¯Î±
  </button>
</div>

<div id="main">
  <h2>ğŸ¤– ChatDim AI (Full Edition - Ï‡Ï‰ÏÎ¯Ï‚ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚)</h2>

  <div id="chat"></div>

  <input type="text" id="userInput" placeholder="Î“ÏÎ¬ÏˆÎµ ÎºÎ¬Ï„Î¹..." />
  <div id="controls">
    <button id="sendBtn">Î£Ï„ÎµÎ¯Î»Îµ</button>
    <button id="speakBtn">ğŸ¤</button>
    <button id="saveBtn">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
  </div>
</div>

<script defer>
document.addEventListener('DOMContentLoaded', () => {
  const OPENROUTER_API_KEY = "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";

  const chat = document.getElementById('chat');
  const input = document.getElementById('userInput');
  const sendBtn = document.getElementById('sendBtn');
  const saveBtn = document.getElementById('saveBtn');
  const speakBtn = document.getElementById('speakBtn');
  const chatList = document.getElementById('chatList');
  const newChatBtn = document.getElementById('newChatBtn');

  let currentChatName = null;
  let history = [];

  function setSelectedChatInList() {
    [...chatList.children].forEach(div => {
      div.classList.toggle('selected', div.getAttribute('data-name') === currentChatName);
    });
  }

  function appendMessage(who, text) {
    const msg = document.createElement('div');
    msg.classList.add('message', who);
    msg.textContent = (who === 'user' ? 'Î•ÏƒÏ: ' : 'AI: ') + text;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
    history.push({who, text});
    saveCurrentHistory();
  }

  function saveCurrentHistory() {
    if(currentChatName) {
      localStorage.setItem('chat_' + currentChatName, JSON.stringify(history));
      localStorage.setItem('chatHistory_current', JSON.stringify(history));
    }
  }

  async function callOpenRouterChat(prompt) {
    try {
      const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${OPENROUTER_API_KEY}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "openchat/openchat-7b:free",
          messages: [
            { role: "system", content: "ÎÎ± Î±Ï€Î±Î½Ï„Î¬Ï‚ ÏƒÏ„Î± ÎµÎ»Î»Î·Î½Î¹ÎºÎ¬, Î¼Îµ Î±ÎºÏÎ¯Î²ÎµÎ¹Î±, ÏƒÎ±Ï†Î®Î½ÎµÎ¹Î± ÎºÎ±Î¹ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ·. ÎÎ± Î»ÎµÏ‚ Ï€Î±ÏÎ±Î´ÎµÎ¯Î³Î¼Î±Ï„Î± ÏŒÏ„Î±Î½ Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹." },
            ...history.map(h => ({
              role: h.who === 'user' ? "user" : "assistant",
              content: h.text
            })),
            { role: "user", content: prompt }
          ],
          temperature: 0.7,
          max_tokens: 1024
        })
      });

      if (!response.ok) {
        const errData = await response.json().catch(() => ({}));
        throw new Error(`API Error ${response.status}: ${errData.message || response.statusText}`);
      }

      const data = await response.json();
      return data.choices?.[0]?.message?.content || "Î”ÎµÎ½ Ï…Ï€Î®ÏÎ¾Îµ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·.";
    } catch (e) {
      return "Î£Ï†Î¬Î»Î¼Î±: " + e.message;
    }
  }

  // Î¤Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± Î´ÎµÎ½ Î¬Î»Î»Î±Î¾Î±Î½ (loadChat, addChatToList, Îº.Î»Ï€.)
  // ... (Î¬Ï†Î·ÏƒÎ± Ï„Î¿Î½ Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î¿ ÎºÏÎ´Î¹ÎºÎ± ÏŒÏ€Ï‰Ï‚ Î®Ï„Î±Î½ Î³Î¹Î± Î»ÏŒÎ³Î¿Ï…Ï‚ Ï‡ÏÏÎ¿Ï…)
});
</script>

</body>
</html>

